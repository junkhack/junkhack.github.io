<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://hack.gpl.jp/xmlrpc.php">

<title>osx &#8211; JunkHack</title>
<style type="text/css">.wpfts-result-item .wpfts-smart-excerpt {}.wpfts-result-item .wpfts-not-found {color:#808080;font-size:0.9em;}.wpfts-result-item .wpfts-score {color:#006621;font-size:0.9em;}.wpfts-shift {margin-left:40px;}.wpfts-result-item .wpfts-download-link {color:#006621;font-size:0.9em;}.wpfts-result-item .wpfts-file-size {color:#006621;font-size:0.9em;}</style><meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//hack.gpl.jp' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="JunkHack &raquo; フィード" href="https://hack.gpl.jp/feed/" />
<link rel="alternate" type="application/rss+xml" title="JunkHack &raquo; コメントフィード" href="https://hack.gpl.jp/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="JunkHack &raquo; osx カテゴリーのフィード" href="https://hack.gpl.jp/category/osx/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/hack.gpl.jp\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' href='./../css/dist-block-library-style.min.css'>
<link rel='stylesheet' href='./../css/export-wp-page-to-static-html-pro-premium-public-css-export-wp-page-to-static-html-public.css'>
<link rel='stylesheet' href='./../css/fulltext-search-style-wpfts_autocomplete.css'>
<link rel='stylesheet' href='./../css/wp-external-links-public-css-wpel.css'>
<link rel='stylesheet' href='./../css/wpfront-scroll-top-css-wpfront-scroll-top.min.css'>
<link rel='stylesheet' href='./../css/ccrw_related-css-frontend-style.css'>
<link rel='stylesheet' id='hew-fonts-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A400%2C600%2C700%2C400italic%2C600italic%2C700italic%7CNoto+Serif%3A400%2C700%2C400italic%2C700italic&#038;subset=latin' type='text/css' media='all' />
<link rel='stylesheet' href='./../css/hew-wpcom-genericons-genericons.css'>
<link rel='stylesheet' href='./../css/hew-wpcom-style.css'>
		<script>
			/* <![CDATA[ */
			var rcewpp = {
				"ajax_url":"https://hack.gpl.jp/wp-admin/admin-ajax.php",
				"nonce": "4eef5ded05",
				"home_url": "https://hack.gpl.jp/",
				"settings_icon": 'https://hack.gpl.jp/wp-content/plugins/export-wp-page-to-static-html-pro-premium/admin/images/settings.png',
				"settings_hover_icon": 'https://hack.gpl.jp/wp-content/plugins/export-wp-page-to-static-html-pro-premium/admin/images/settings_hover.png'
			};
			/* ]]\> */
		</script>
		<script type='text/javascript' src='./../js/jquery-3.5.1.min.js' id='jquery-core-js'></script>
<script type='text/javascript' src='./../js/jquery-migrate-3.3.0.min.js' id='jquery-migrate-js'></script>
<script type='text/javascript' src='./../js/export-wp-page-to-static-html-public.js' id='export-wp-page-to-static-html-js'></script>
<script type='text/javascript' src='./../js/wpfts_frontend.js' id='wpfts_frontend-js'></script>
<link rel="https://api.w.org/" href="https://hack.gpl.jp/wp-json/" /><link rel="alternate" type="application/json" href="https://hack.gpl.jp/wp-json/wp/v2/categories/62" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://hack.gpl.jp/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://hack.gpl.jp/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 5.7.2" />
<script type="text/javascript">
		document.wpfts_ajaxurl = "https://hack.gpl.jp/wp-admin/admin-ajax.php";
	</script>				<style id="uagb-style-conditional-extension">@media (min-width: 1025px){body .uag-hide-desktop.uagb-google-map__wrap,body .uag-hide-desktop{display:none}}@media (min-width: 768px) and (max-width: 1024px){body .uag-hide-tab.uagb-google-map__wrap,body .uag-hide-tab{display:none}}@media (max-width: 767px){body .uag-hide-mob.uagb-google-map__wrap,body .uag-hide-mob{display:none}}</style>
			<script data-ad-client="ca-pub-2711753458083215" async src="./../js/adsbygoogle.js"></script>
</head>

<script async src="./../js/6428.js"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-13YWDXYQE2');
</script>
<body class="archive category category-osx category-62 has-sidebar">
<div id="page" class="hfeed site">
		<div id="widgets-wrapper" class="hide">
		
<div id="secondary" class="wrap top-widget-area" role="complementary">
	
	
	
		<div id="sidebar-4" class="widget-area" role="complementary">
		<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://hack.gpl.jp/">
				<label>
					<span class="screen-reader-text">検索:</span>
					<input type="search" class="search-field" placeholder="検索&hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="検索" />
			</form></aside>	</div><!-- #four .widget-area -->
	</div><!-- #secondary -->
	</div>
	
	<a class="skip-link screen-reader-text" href="">コンテンツへ移動</a>

	<header id="masthead" class="site-header" role="banner">
		
		<div class="site-branding">
			<h1 class="site-title"><a href="./../index.html" rel="home noopener noreferrer" data-wpel-link="internal">JunkHack</a></h1>
			<h2 class="site-description">アリエクでポチった JUNKHACK</h2>
		</div>

					<nav id="site-navigation" class="main-navigation" role="navigation">
				<button class="menu-toggle toggle-button"><span class="screen-reader-text">メインメニュー</span></button>
				<div class="menu-new-menu-container"><ul id="menu-new-menu" class="menu"><li id="menu-item-9578" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-9578"><a href="./../index.html" data-wpel-link="internal" rel="noopener noreferrer">List</a></li>
<li id="menu-item-9594" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-9594"><a href="./../status.html" data-wpel-link="internal" rel="noopener noreferrer">Status</a></li>
</ul></div>			</nav><!-- #site-navigation -->
		
		
				<div class="toggle-wrapper">
			<a href="" class="widgets-toggle toggle-button" title="ウィジェット">
				<span class="screen-reader-text">ウィジェット</span>
			</a>
		</div>
		
	</header><!-- #masthead -->

	<div id="content" class="site-content">

	<section id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			<header class="page-header">
				<h1 class="page-title">カテゴリー: <span>osx</span></h1>			</header><!-- .page-header -->

						
				
<article id="post-843" class="post-843 post type-post status-publish format-standard hentry category-osx category-raspberry-pi">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="./../843.html" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-07-12T17:51:51+09:00">2015年7月12日</time></a> </span><span class="posted-on">更新日:2015年7月12日</span> <span class="categories">  <a href="./../category/osx.html" rel="category tag noopener noreferrer" data-wpel-link="internal">osx</a>, <a href="./../category/raspberry-pi.html" rel="category tag noopener noreferrer" data-wpel-link="internal">Raspberry Pi</a></span>			</div><!-- .entry-meta -->

							<h1 class="entry-title"><a href="./../ /843.html" rel="bookmark noopener noreferrer" data-wpel-link="internal">osx10.9 で UnixBench</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>ここのところ、RasPi2 でいろいろ遊んでいますが、そういえば母艦である osx 機で UnixBench を計測していないことに気がつきました。で、その結果。</p>
<p>&nbsp;</p>
<p>UnixBench にパッチを当てる情報は、以下を参考にしました。</p>
<blockquote><p>Patch for UnixBench 5.1.3 on Mac OS X Mavericks (10.9)<br />
<a href="https://gist.github.com/barusan/11033924" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">https://gist.github.com/barusan/11033924<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p>blog<br />
<a href="http://www.baru-san.net/archives/267" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://www.baru-san.net/archives/267<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p></blockquote>
<p>ありがたく、使わせていただきます。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">wget https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/byte-unixbench/UnixBench5.1.3.tgz
git clone https://gist.github.com/11033924.git
tar xvf UnixBench5.1.3.tgz
cd UnixBench/
patch -p1 &lt; ../11033924/UnixBench5.1.3.mavericks.patch
make
./Run</pre>
<p>な感じで計測。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">========================================================================
   BYTE UNIX Benchmarks (Version 5.1.3)

   System: HOPE.local: Darwin
   OS: Darwin -- 13.4.0 -- Darwin Kernel Version 13.4.0: ....::
::
   CPU 7: Intel(R) Core(TM) ...::
::

------------------------------------------------------------------------
Benchmark Run: 日  7 12 2015 16:14:49 - 16:42:55
8 CPUs in system; running 1 parallel copy of tests

Dhrystone 2 using register variables       34704465.0 lps   (10.0 s, 7 samples)
Double-Precision Whetstone                     6360.0 MWIPS (9.8 s, 7 samples)
Execl Throughput                                903.5 lps   (29.9 s, 2 samples)
File Copy 1024 bufsize 2000 maxblocks        800480.2 KBps  (30.0 s, 2 samples)
File Copy 256 bufsize 500 maxblocks          219592.2 KBps  (30.0 s, 2 samples)
File Copy 4096 bufsize 8000 maxblocks       2163139.0 KBps  (30.0 s, 2 samples)
Pipe Throughput                             1281398.1 lps   (10.0 s, 7 samples)
Pipe-based Context Switching                 103377.8 lps   (10.0 s, 7 samples)
Process Creation                               4573.6 lps   (30.0 s, 2 samples)
Shell Scripts (1 concurrent)                   5948.9 lpm   (60.0 s, 2 samples)
Shell Scripts (8 concurrent)                   1956.7 lpm   (60.0 s, 2 samples)
System Call Overhead                        1350215.3 lps   (10.0 s, 7 samples)

System Benchmarks Index Values               BASELINE       RESULT    INDEX
Dhrystone 2 using register variables         116700.0   34704465.0   2973.8
Double-Precision Whetstone                       55.0       6360.0   1156.4
Execl Throughput                                 43.0        903.5    210.1
File Copy 1024 bufsize 2000 maxblocks          3960.0     800480.2   2021.4
File Copy 256 bufsize 500 maxblocks            1655.0     219592.2   1326.8
File Copy 4096 bufsize 8000 maxblocks          5800.0    2163139.0   3729.6
Pipe Throughput                               12440.0    1281398.1   1030.1
Pipe-based Context Switching                   4000.0     103377.8    258.4
Process Creation                                126.0       4573.6    363.0
Shell Scripts (1 concurrent)                     42.4       5948.9   1403.0
Shell Scripts (8 concurrent)                      6.0       1956.7   3261.2
System Call Overhead                          15000.0    1350215.3    900.1
                                                                   ========
System Benchmarks Index Score                                        1092.0

------------------------------------------------------------------------
Benchmark Run: 日  7 12 2015 16:42:55 - 17:11:05
8 CPUs in system; running 8 parallel copies of tests

Dhrystone 2 using register variables      151501922.0 lps   (10.0 s, 7 samples)
Double-Precision Whetstone                    47934.1 MWIPS (9.8 s, 7 samples)
Execl Throughput                               4391.2 lps   (29.9 s, 2 samples)
File Copy 1024 bufsize 2000 maxblocks       1785300.9 KBps  (30.0 s, 2 samples)
File Copy 256 bufsize 500 maxblocks          417942.6 KBps  (30.0 s, 2 samples)
File Copy 4096 bufsize 8000 maxblocks       5208018.8 KBps  (30.0 s, 2 samples)
Pipe Throughput                             3024743.9 lps   (10.0 s, 7 samples)
Pipe-based Context Switching                 737487.3 lps   (10.0 s, 7 samples)
Process Creation                              17603.0 lps   (30.0 s, 2 samples)
Shell Scripts (1 concurrent)                  17545.1 lpm   (60.0 s, 2 samples)
Shell Scripts (8 concurrent)                   2572.0 lpm   (60.1 s, 2 samples)
System Call Overhead                        3138596.8 lps   (10.0 s, 7 samples)

System Benchmarks Index Values               BASELINE       RESULT    INDEX
Dhrystone 2 using register variables         116700.0  151501922.0  12982.2
Double-Precision Whetstone                       55.0      47934.1   8715.3
Execl Throughput                                 43.0       4391.2   1021.2
File Copy 1024 bufsize 2000 maxblocks          3960.0    1785300.9   4508.3
File Copy 256 bufsize 500 maxblocks            1655.0     417942.6   2525.3
File Copy 4096 bufsize 8000 maxblocks          5800.0    5208018.8   8979.3
Pipe Throughput                               12440.0    3024743.9   2431.5
Pipe-based Context Switching                   4000.0     737487.3   1843.7
Process Creation                                126.0      17603.0   1397.1
Shell Scripts (1 concurrent)                     42.4      17545.1   4138.0
Shell Scripts (8 concurrent)                      6.0       2572.0   4286.7
System Call Overhead                          15000.0    3138596.8   2092.4
                                                                   ========
System Benchmarks Index Score                                        3440.0</pre>
<p>osx 10.9.5 ですが、体感的にはもっと速い感じ。まぁ、とりあえずの指針としてきます。</p>
<p>たとえば、sakuraVPS の2G Plan の CPU3 RAM 2GB HDD200GB で2000くらいは出ます。</p>
<p>&nbsp;</p>
<p>ベンチマーク計測中の htop は以下のような感じ。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">  1  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||100.0%]     Tasks: 252 total, 0 running
  2  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||100.0%]     Load average: 7.85 5.22 3.26 
  3  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||100.0%]     Uptime: 01:03:57
  4  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||100.0%]
  5  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||100.0%]
  6  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||100.0%]
  7  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||100.0%]
  8  [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||100.0%]
  Mem[||||||||||||                                        3711/32768MB]
  Swp[                                                        0/1024MB]</pre>
<p>がんばってますね。</p>
<p>ちなみに、osx10.9.5 の公開しているソースは、</p>
<p><a title="http://www.opensource.apple.com/release/os-x-1095/" href="http://www.opensource.apple.com/release/os-x-1095/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://www.opensource.apple.com/release/os-x-1095/<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p>たとえば、bash とかは、以下にあり、</p>
<p><a title="http://www.opensource.apple.com/source/bash/bash-92/" href="http://www.opensource.apple.com/source/bash/bash-92/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://www.opensource.apple.com/source/bash/bash-92/<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p>まだやったことはないんですが、xcode を使ってビルドできるようです。</p>
<p><img loading="lazy" style="float:none;margin-left:auto;display:block;margin-right:auto;border:0;" title="Source_Browser" src="./../images/source_browser.png" alt="Source_Browser" width="550" height="480" border="0" /></p>
					</div><!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div><!-- .entry-wrapper -->
</article><!-- #post-## -->

			
				
<article id="post-875" class="post-875 post type-post status-publish format-standard hentry category-osx">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="./../875.html" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-07-20T03:54:17+09:00">2015年7月20日</time></a> </span><span class="posted-on">更新日:2015年7月20日</span> <span class="categories">  <a href="./../category/osx.html" rel="category tag noopener noreferrer" data-wpel-link="internal">osx</a></span>			</div><!-- .entry-meta -->

							<h1 class="entry-title"><a href="./../ /875.html" rel="bookmark noopener noreferrer" data-wpel-link="internal">ExtFSのマウント指定</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>osx に、Pragon ExtFS を入れている場合、マウントのタイプに指定するオプションは、以下のようです。</p>
<p>iSCSI デバイスをReadOnly でマウントしたかった時にタイプ指定が不明だったのでめも。ext2,3,4 の判別は Pragon ExtFS がやってくれる模様。</p>
<blockquote>
<p>$ sudo mkdir /Volumes/berryboot     <br />$ sudo mount -r -t ufsd_ExtFS /dev/disk3s1 /Volumes/berryboot</p>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ^^^^^^^</p>
</blockquote>
<p><img loading="lazy" title="osxreadonly" style="border-top:0;border-right:0;border-bottom:0;float:none;margin-left:auto;border-left:0;display:block;margin-right:auto;" border="0" alt="osxreadonly" src="./../images/osxreadonly.png" width="266" height="546" /> </p>
<p>扱えるタイプは、以下。NTFS や ext2,3,4 は Paragon のに依存しています。osx 標準じゃありませんので。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">$ ll /System/Library/Filesystems/
total 8
drwxr-xr-x  6 root  wheel  204 12 20  2014 AppleShare
drwxr-xr-x  7 root  wheel  238 12 20  2014 NetFSPlugins
drwxr-xr-x  4 root  wheel  136  5 30  2014 acfs.fs
lrwxr-xr-x  1 root  wheel   49 12 20  2014 afpfs.fs -&gt; /System/Library/Filesystems/AppleShare/afpfs.kext
drwxr-xr-x  3 root  wheel  102  6  4  2014 cd9660.fs
drwxr-xr-x  3 root  wheel  102  6  4  2014 cddafs.fs
drwxr-xr-x  4 root  wheel  136 12 20  2014 exfat.fs
drwxr-xr-x  5 root  wheel  170  8 25  2013 ftp.fs
drwxr-xr-x  5 root  wheel  170 12 20  2014 hfs.fs
drwxr-xr-x  4 root  wheel  136 12 20  2014 msdos.fs
drwxr-xr-x  3 root  wheel  102  8 25  2013 nfs.fs
drwxr-xr-x  4 root  wheel  136 12 20  2014 ntfs.fs
drwxr-xr-x  3 root  wheel  102  6  4  2014 smbfs.fs
drwxr-xr-x  4 root  wheel  136 12 20  2014 udf.fs
drwxr-xr-x  3 root  wheel  102 11 12  2014 ufsd_ExtFS.fs
drwxr-xr-x  3 root  wheel  102  9  9  2013 ufsd_NTFS.fs
drwxr-xr-x  4 root  wheel  136 12 20  2014 webdav.fs</pre>
<p>&#160;</p>
<p>ちなみに、Finderがマウント解除するときに、/Volumes/以下に作ったディレクトリも削除してくれるようです。</p>
					</div><!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div><!-- .entry-wrapper -->
</article><!-- #post-## -->

			
				
<article id="post-891" class="post-891 post type-post status-publish format-standard hentry category-linux category-osx category-raspberry-pi">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="https://hack.gpl.jp/891/" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-07-25T17:09:06+09:00">2015年7月25日</time></a> </span><span class="posted-on">更新日:2015年7月25日</span> <span class="categories">  <a href="./../category/linux.html" rel="category tag noopener noreferrer" data-wpel-link="internal">Linux</a>, <a href="./../category/osx.html" rel="category tag noopener noreferrer" data-wpel-link="internal">osx</a>, <a href="./../category/raspberry-pi.html" rel="category tag noopener noreferrer" data-wpel-link="internal">Raspberry Pi</a></span>			</div><!-- .entry-meta -->

							<h1 class="entry-title"><a href="./../ /891.html" rel="bookmark noopener noreferrer" data-wpel-link="internal">NFS Boot に成功した</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>とりあえず、NFS Boot は本当にできるのか試してみました。結果、できました。   <br />実際やってみると、いろいろとはまるところがありましたが、おおむね以下の手順。忘れないうちにメモしておきます。</p>
<p>▼環境</p>
<p>NFS Server・・・・osx 10.9.5</p>
<p>Boot OS・・・・・ 2015-05-05-raspbian-wheezy</p>
<p>&#160;</p>
<p>▼操作の流れ</p>
<p>・NFS サーバでシェアする用意</p>
<p>・arm 用の img のルートファイルシステムを NFS へコピー（大体は第２パーティションにあり。Fedora とは3番目）</p>
<p>・SDCard の FATフォーマットの boot の cmdline.txt へ nfs boot する設定と、IP の設定</p>
<p>&#160;</p>
<p>▼osx の NFS Server 側</p>
<p>NFSの設定を入れて、nfsd を再起動。操作はroot でやっています。オンラインマニュアルは<a href="https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man8/nfsd.8.html" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-right">ここ<span class="wpel-icon wpel-image wpel-icon-1"></span></a>。</p>
<blockquote>
<p>&#8212;- /etc/exports      <br />/nfs/fedora22 -rw -mapall=root:wheel -network 192.168.1.0 -mask 255.255.255.0</p>
</blockquote>
<p>exports ファイルがあればnfsd が起動しますが、手動で操作したい場合は</p>
<blockquote>
<p># nfsd start | stop</p>
</blockquote>
<p>NFS で提供しているパスの確認。</p>
<blockquote>
<p># showmount -e localhost     <br />Exports list on localhost:      <br />/nfs/fedora22&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 192.168.1.0      <br />::</p>
</blockquote>
<p>最初fedora22 入れようとして、失敗して、RASPIAN 入れたので名前があれですが。</p>
<p>それで、boot したい img をコピー。以下は、centos6.x で、osx の NFS をマウントして、rsync しています。centos6はバーチャルボックスでosx を同じネットワークセグメントにいます。</p>
<blockquote>
<p>[root@cent66 etc]# df -hT     <br />Filesystem&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Type&#160;&#160;&#160;&#160; Size&#160; Used Avail Use% Mounted on      <br />::      <br />hope.junkhack:/exports&#160;&#160;&#160;&#160;&#160;&#160; nfs&#160;&#160;&#160;&#160;&#160; 466G&#160; 390G&#160;&#160; 76G&#160; 84% /nfs      <br />hope.junkhack:/nfs/fedora22&#160; nfs&#160;&#160;&#160;&#160;&#160; 466G&#160; 390G&#160;&#160; 76G&#160; 84% /mnt/fedora22</p>
</blockquote>
<p>hope.junkhack は名前解決できるようにしてあります。ちなみに、fstab はこんな感じのデフォルト。</p>
<blockquote>
<p>&#8212;- /etc/fstab     <br />::      <br />hope.junkhack:/exports&#160;&#160;&#160; /nfs&#160;&#160;&#160;&#160;&#160;&#160;&#160; nfs&#160;&#160;&#160;&#160;&#160;&#160;&#160; defaults&#160;&#160;&#160; 0 0      <br />hope.junkhack:/nfs/fedora22&#160;&#160;&#160; /mnt/fedora22&#160;&#160;&#160; nfs&#160;&#160;&#160;&#160;&#160;&#160;&#160; defaults&#160;&#160;&#160; 0 0</p>
</blockquote>
<p>で、RASPIAN のイメージをマウント。</p>
<blockquote>
<p>[root@cent66 RASPBIAN]# kpartx -av 2015-05-05-raspbian-wheezy.img      <br />add map loop0p1 (253:2): 0 114688 linear /dev/loop0 8192      <br />add map loop0p2 (253:3): 0 6277120 linear /dev/loop0 122880</p>
<p>[root@cent66 RASPBIAN]# mount /dev/mapper/loop0p2 /mnt/raspi/     </p>
<p>[root@cent66 RASPBIAN]# df -h      <br />Filesystem&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Size&#160; Used Avail Use% Mounted on      <br />::      <br />hope.junkhack:/exports&#160;&#160;&#160;&#160;&#160;&#160;&#160; 466G&#160; 388G&#160;&#160; 78G&#160; 84% /nfs      <br />hope.junkhack:/nfs/fedora22&#160;&#160; 466G&#160; 388G&#160;&#160; 78G&#160; 84% /mnt/fedora22      <br />/dev/mapper/loop0p2&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 3.0G&#160; 2.4G&#160; 451M&#160; 85% /mnt/raspi      <br />[root@cent66 RASPBIAN]# </p>
</blockquote>
<p>で、コピー。</p>
<blockquote>
<p>[root@cent66 RASPBIAN]# rsync -av /mnt/raspi/ /mnt/fedora22/     <br />sending incremental file list      <br />./      <br />bin/      <br />bin/bash      <br />bin/bunzip2</p>
<p>::</p>
<p>var/spool/cron/crontabs/     <br />var/spool/rsyslog/      <br />var/tmp/ </p>
<p>sent 2304687346 bytes&#160; received 1293752 bytes&#160; 4274293.05 bytes/sec     <br />total size is 2299569061&#160; speedup is 1.00      <br />[root@cent66 RASPBIAN]# </p>
<p>&#160;</p>
</blockquote>
<p>で、NFS でブートするときに fstab の中がそのままだと、SD カードのパーティションをchroot してしまうのでコメントアウト。</p>
<blockquote>
<p>[root@cent66 etc]# vim fstab</p>
<p>proc&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; /proc&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; proc&#160;&#160;&#160; defaults&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0&#160;&#160;&#160;&#160;&#160;&#160; 0     <br />/dev/mmcblk0p1&#160; /boot&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vfat&#160;&#160;&#160; defaults&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0&#160;&#160;&#160;&#160;&#160;&#160; 2      <br />#/dev/mmcblk0p2&#160; /&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ext4&#160;&#160;&#160; defaults,noatime&#160; 0&#160;&#160;&#160;&#160;&#160;&#160; 1</p>
</blockquote>
<p>NFS側のイメージ展開は以上で終わり。</p>
<p>&#160;</p>
<p>▼Boot するcmdline.txt の中に以下を追加</p>
<blockquote>
<p>root=/dev/nfs rootfstype=nfs nfsroot=192.168.1.17:/nfs/fedora22,udp,vers=3,nolock ip=192.168.1.24:192.168.1.17:192.168.1.1:255.255.255.0:rpi:eth0:off</p>
</blockquote>
<p>nolock のオプションは必要ないかもしれません。とりあえず、これで動いてはいます。IPのところは以下の書式。</p>
<blockquote>
<p>ip=&lt;raspberrypi_ip&gt;:&lt;nfs_server_ip&gt;:&lt;default_gateway&gt;:&lt;mask&gt;:rpi:eth0:off</p>
</blockquote>
<p>シリアルコンソールのブートログは、</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">[    4.638898] smsc95xx 1-1.1:1.0 eth0: link up, 100Mbps, full-duplex, lpa 0xC5E1

[    4.674857] IP-Config: Complete:

[    4.680180]      device=eth0, hwaddr=b8:27:eb:97:45:fb, ipaddr=192.168.1.24, mask=255.255.255.0, gw=192.168.1.1

[    4.694694]      host=rpi, domain=, nis-domain=(none)

[    4.701878]      bootserver=192.168.1.17, rootserver=192.168.1.17, rootpath=

[    4.719859] VFS: Mounted root (nfs filesystem) readonly on device 0:14.

[    4.729328] devtmpfs: mounted

[    4.735147] Freeing unused kernel memory: 400K (80786000 - 807ea000)

[    5.132474] random: nonblocking pool is initialized

[    6.228285] udevd[177]: starting version 175



Raspbian GNU/Linux 7 pi ttyAMA0



pi login: </pre>
<p>となっています。</p>
<p>NFS Boot させたあと、uname したら、</p>
<blockquote>
<p>root@pi:~# uname -a<br />
    <br />Linux pi 4.0.7-v7+ #801 SMP PREEMPT Tue Jun 30 18:38:23 BST 2015 armv7l GNU/Linux</p>
<p>root@pi:~# </p>
</blockquote>
<p>げ、fedora の initramfs からブートしてます。SDCard の boot は、初回にスクリプトで作ったやつだった。。。。</p>
<blockquote>
<p>root@pi:/boot# ll *.img<br />
    <br />-rwxr-xr-x 1 root root 39176850 Jul&#160; 4 17:40 initramfs-0-rescue-18b4f0b4546f49828e1ef5e652cc7b9a.img</p>
<p>-rwxr-xr-x 1 root root 16475761 Jul&#160; 4 17:36 initramfs-4.0.6-300.fc22.armv7hl+lpae.img</p>
<p>-rwxr-xr-x 1 root root&#160; 3987856 Jul&#160; 2 23:35 kernel7.img</p>
<p>-rwxr-xr-x 1 root root&#160; 4016696 Jul&#160; 2 23:35 kernel.img</p>
<p>root@pi:/boot# </p>
</blockquote>
<p>たぶん、RASPIAN のimg の boot からやれば、良いはず。まだ試していませんが。</p>
<p>df はこんな感じで、ルートがnfs になっています。76Gも空きがあるー（osx 側のディスクですが）</p>
<blockquote>
<p>root@pi:~# df -hT<br />
    <br />Filesystem&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Type&#160;&#160;&#160;&#160;&#160; Size&#160; Used Avail Use% Mounted on</p>
<p>192.168.1.17:/nfs/fedora22 nfs&#160;&#160;&#160;&#160;&#160;&#160; 466G&#160; 390G&#160;&#160; 76G&#160; 84% /</p>
<p>devtmpfs&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; devtmpfs&#160; 459M&#160;&#160;&#160;&#160; 0&#160; 459M&#160;&#160; 0% /dev</p>
<p>tmpfs&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tmpfs&#160;&#160;&#160;&#160;&#160; 93M&#160; 216K&#160;&#160; 93M&#160;&#160; 1% /run</p>
<p>tmpfs&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tmpfs&#160;&#160;&#160;&#160; 5.0M&#160;&#160;&#160;&#160; 0&#160; 5.0M&#160;&#160; 0% /run/lock</p>
<p>tmpfs&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tmpfs&#160;&#160;&#160;&#160; 186M&#160;&#160;&#160;&#160; 0&#160; 186M&#160;&#160; 0% /run/shm</p>
<p>/dev/mmcblk0p1&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vfat&#160;&#160;&#160;&#160;&#160; 200M&#160;&#160; 98M&#160; 102M&#160; 50% /boot</p>
</blockquote>
<p>このままだと、モジュールを読み込んでいないので使えませんが、、、</p>
<blockquote>
<p>root@pi:~# lsmod<br />
    <br />Module&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Size&#160; Used by</p>
<p>root@pi:~# ll /lib/modules/</p>
<p>total 8</p>
<p>drwxr-xr-x 14 root root 476 May&#160; 6 22:22 3.18.11+</p>
<p>drwxr-xr-x 14 root root 476 May&#160; 6 22:22 3.18.11-v7+</p>
<p>root@pi:~# </p>
</blockquote>
<p>Boot の img を RASPBIAN のに入れ替えて、リブート</p>
<blockquote>
<p>[root@pi ~ 07/25 20:40:51]# ll /boot/*.img<br />
    <br />-rwxr-xr-x 1 root root 3930004 Apr 27 13:40 /boot/kernel7.img</p>
<p>-rwxr-xr-x 1 root root 3974884 Apr 27 13:40 /boot/kernel.img</p>
</blockquote>
<p>これでkernel も ローダブルモジュールもOK な感じ。</p>
<blockquote>
<p>[root@pi ~ 07/25 20:41:40]# uname -a<br />
    <br />Linux pi 3.18.11-v7+ #781 SMP PREEMPT Tue Apr 21 18:07:59 BST 2015 armv7l GNU/Linux</p>
<p>[root@pi ~ 07/25 20:44:14]# lsmod</p>
<p>Module&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Size&#160; Used by</p>
<p>cfg80211&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 386508&#160; 0 </p>
<p>rfkill&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 16651&#160; 1 cfg80211</p>
<p>rpcsec_gss_krb5&#160;&#160;&#160;&#160;&#160;&#160;&#160; 20958&#160; 0 </p>
<p>nfsd&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 263569&#160; 2 </p>
<p>snd_bcm2835&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 18649&#160; 0 </p>
<p>snd_pcm&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 73475&#160; 1 snd_bcm2835</p>
<p>snd_seq&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 53078&#160; 0 </p>
<p>snd_seq_device&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 5628&#160; 1 snd_seq</p>
<p>snd_timer&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 17784&#160; 2 snd_pcm,snd_seq</p>
<p>snd&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 51038&#160; 5 snd_bcm2835,snd_timer,snd_pcm,snd_seq,snd_seq_device</p>
<p>8192cu&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 528365&#160; 0 </p>
<p>joydev&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 8879&#160; 0 </p>
<p>evdev&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 9950&#160; 2 </p>
<p>uio_pdrv_genirq&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 2958&#160; 0 </p>
<p>uio&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 8119&#160; 1 uio_pdrv_genirq</p>
</blockquote>
					</div><!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div><!-- .entry-wrapper -->
</article><!-- #post-## -->

			
				
<article id="post-900" class="post-900 post type-post status-publish format-standard hentry category-filesystem category-linux category-osx category-raspberry-pi">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="https://hack.gpl.jp/900/" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-07-25T22:16:28+09:00">2015年7月25日</time></a> </span><span class="posted-on">更新日:2015年7月25日</span> <span class="categories">  <a href="https://hack.gpl.jp/category/filesystem/" rel="category tag noopener noreferrer" data-wpel-link="internal">FileSystem</a>, <a href="./../category/linux.html" rel="category tag noopener noreferrer" data-wpel-link="internal">Linux</a>, <a href="./../category/osx.html" rel="category tag noopener noreferrer" data-wpel-link="internal">osx</a>, <a href="./../category/raspberry-pi.html" rel="category tag noopener noreferrer" data-wpel-link="internal">Raspberry Pi</a></span>			</div><!-- .entry-meta -->

							<h1 class="entry-title"><a href="./../ /900.html" rel="bookmark noopener noreferrer" data-wpel-link="internal">NFS Boot の IOPS</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>fio の手順が載っていたので、以下でNFS Boot の IO性能を計測。</p>
<p>母艦のosx の DISK は SSD です。Samsung MZ-7TD500BW 840 SSD </p>
<blockquote>
<p>cd /usr/local/src/     <br />sudo apt-get install -y libaio-dev      <br />git clone -b fio-2.2.5 git://git.kernel.dk/fio.git      <br />cd fio      <br />./configure &amp;&amp; make &amp;&amp; sudo make install      <br />cd ..      <br />wget <a href="http://www.winkey.jp/downloads/visit.php/fio-crystaldiskmark" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://www.winkey.jp/downloads/visit.php/fio-crystaldiskmark<span class="wpel-icon wpel-image wpel-icon-1"></span></a>      <br />fio fio-crystaldiskmark | perl -ne &#8216;      <br />print &quot;$1 : &quot; if(/(.+): \(groupid=/);      <br />print &quot;$1 &quot; if(/bw=([\d. ]+[KM]?B\/s)/);      <br />print &quot;[ $1 IOPS]\n&quot; if(/iops=(\d+)/)&#8217;</p>
</blockquote>
<p>4K の読み書きが SDCard よりだんぜん速いです。</p>
<blockquote>
<p>Seq-Read : 9555.8KB/s [ 9 IOPS]     <br />Seq-Write : 10250KB/s [ 10 IOPS]      <br />Rand-Read-512K : 9145.4KB/s [ 17 IOPS]      <br />Rand-Write-512K : 10085KB/s [ 19 IOPS]      <br />Rand-Read-4K : 3624.8KB/s [ 906 IOPS]      <br />Rand-Write-4K : 3300.5KB/s [ 825 IOPS]      <br />Rand-Read-4K-QD32 : 8885.1KB/s [ 2221 IOPS]      <br />Rand-Write-4K-QD32 : 10492KB/s [ 2622 IOPS]</p>
</blockquote>
<p>なるほどー。いいかも。</p>
<p>&#160;</p>
<p>参考</p>
<blockquote>
<p>discypus.jp/wiki/ </p>
<p><a href="http://discypus.jp/wiki/?%C1%C8%A4%DF%B9%FE%A4%DF%2FRaspberryPi" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-right">fio &#8211; Flexible I/O Tester (2015-02-22)<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
</blockquote>
					</div><!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div><!-- .entry-wrapper -->
</article><!-- #post-## -->

			
				
<article id="post-911" class="post-911 post type-post status-publish format-standard hentry category-osx category-raspberry-pi">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="./../911.html" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-07-26T08:25:05+09:00">2015年7月26日</time></a> </span><span class="posted-on">更新日:2015年7月26日</span> <span class="categories">  <a href="./../category/osx.html" rel="category tag noopener noreferrer" data-wpel-link="internal">osx</a>, <a href="./../category/raspberry-pi.html" rel="category tag noopener noreferrer" data-wpel-link="internal">Raspberry Pi</a></span>			</div><!-- .entry-meta -->

							<h1 class="entry-title"><a href="./../ /911.html" rel="bookmark noopener noreferrer" data-wpel-link="internal">NFS Boot でタイムマシーンから復元</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>osx 上の nfs で RasPi をブートしているので、タイムマシンからインストール直後に復元できるかやってみました。</p>
<p>&#160;</p>
<p>まず、インストール直後、pi の電源を落とした状態で、タイムマシーンでバックアップを取得。対象は、nfs 直下のところだけにしています。</p>
<p><img loading="lazy" title="Time_Machine" style="border-top:0;border-right:0;border-bottom:0;float:none;margin-left:auto;border-left:0;display:block;margin-right:auto;" border="0" alt="Time_Machine" src="./../images/time_machine.png" width="640" height="428" /> </p>
<p>現在の、パッケージ数の状態</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">[root@pi modules 07/26 06:19:54]# dpkg -l | wc -l
875
[root@pi modules 07/26 06:19:57]# </pre>
<p>nginx でも入れてみます。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">[root@pi ~ 07/26 07:33:55]# dpkg -l | wc -l
878
[root@pi ~ 07/26 07:33:56]# </pre>
<p>パッケージ数が増えました。</p>
<p>で、設定やら、バージョンやらつついた後に、やっぱりやーめた（よくある事）、ということで初期状態に戻します。</p>
<p>&#160;</p>
<p>pi はあらかじめ、シャットダウンしておきます。</p>
<p>タイムマシーンに入ります。</p>
<p><img loading="lazy" title="1" style="border-top:0;border-right:0;border-bottom:0;float:none;margin-left:auto;border-left:0;display:block;margin-right:auto;" border="0" alt="1" src="./../images/11.png" width="640" height="402" /> </p>
</p>
<p>dev を除外して、すべて選択。</p>
<p><img loading="lazy" title="2" style="border-top:0;border-right:0;border-bottom:0;float:none;margin-left:auto;border-left:0;display:block;margin-right:auto;" border="0" alt="2" src="./../images/21.png" width="555" height="358" /> </p>
<p>で、ブート。</p>
<pre class="brush: cpp; gutter: false; toolbar: false; collapse: true; auto-links: false; smart-tabs: false;">[root@pi / 07/26 08:21:25]# dpkg -l | wc -l
875
[root@pi / 07/26 08:21:29]# </pre>
<p>便利ー！ </p>
<p>FreeNAS + iSCSIやNFS 環境 でもスナップショットを使えばできるとは思いますが、この手軽さにはかないません。</p>
<p>オンラインバックアップが正常に動作するかは、sync している状態次第だと思うので、どうなるかわかりませんが。nfs のオプションにsync つけておけばいいのかしらね。</p>
<p>&#160;</p>
<p>とりあえず、部屋が暑くてもうPCからは離脱。満喫か、温泉でも行ってきますかねー。空が夏！</p>
					</div><!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div><!-- .entry-wrapper -->
</article><!-- #post-## -->

			
				
<article id="post-1515" class="post-1515 post type-post status-publish format-standard hentry category-esp8266 category-espeink category-osx category-pcb">
	<div class="entry-wrapper">



		<header class="entry-header">
					<span class="entry-format theme-genericon"></span>
	
			<div class="entry-meta">
				<span class="posted-on">投稿日: <a href="./../1515.html" rel="bookmark noopener noreferrer" data-wpel-link="internal"><time class="entry-date published updated" datetime="2015-10-26T23:25:11+09:00">2015年10月26日</time></a> </span><span class="posted-on">更新日:2015年10月26日</span> <span class="categories">  <a href="./../category/esp8266.html" rel="category tag noopener noreferrer" data-wpel-link="internal">ESP8266</a>, <a href="./../category/espeink.html" rel="category tag noopener noreferrer" data-wpel-link="internal">espeink</a>, <a href="./../category/osx.html" rel="category tag noopener noreferrer" data-wpel-link="internal">osx</a>, <a href="./../category/pcb.html" rel="category tag noopener noreferrer" data-wpel-link="internal">PCB</a></span>			</div><!-- .entry-meta -->

							<h1 class="entry-title"><a href="./../ /1515.html" rel="bookmark noopener noreferrer" data-wpel-link="internal">espeink で試すことメモ</a></h1>					</header><!-- .entry-header -->

		<div class="entry-content">
			<p>編集後記</p>
<p>いくつか、勘違いしていたことがわかりました。</p>
<p>まず、espeink のソースは10月以降に新しくなっていないこと。新しくなっていたのは、フォーラムのスレッドにあるように、<a href="http://git.spritesserver.nl/espeink.git/" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-right">esphttpd<span class="wpel-icon wpel-image wpel-icon-1"></span></a> のソースでした。espeink も esphttpd の両方とも原作者は、sprite_tm さんですので勘違いしていたようです。</p>
<p>&#160;</p>
<p>あと、 includes/ 以下には、c_types.h はなく、そして何もしなくてもSDK v1.0.1 ではコンパイルできました。</p>
<p>なので、今作っている開発ボード上でESP13 （SDK1.0.1を使い）でまずは動作しそうかを検討し、いけそうならPCB設計をESP13 用に書き直して、まずは実験再開です。</p>
<p>espeink のソースは検索するかぎり、誰も手をつけていなさそうなので、最新のSDK で通すにはメモリ関連をはじめ、そこそこ手をつけないと動作しなさそうです。</p>
<p>&#160;</p>
<p>海外の方から、英語で書いてないから良くわかんないけど、結局SDK は何にしてるのとコメントがありました。まぁ、こっちも今検証している段階だから、なんとも言えないのですが、まずはSDK1.0.1 でやる方針で、最終目標は、ESP13 + SDK 最新で動作するようフィックスしたいんですけどね。</p>
<p>&#160;</p>
<p>github に英語版の手順を作っておこうかしらね。git の使い方の練習にもなるし。</p>
<p>&#160;</p>
<p>ということで、現在のまとめ。</p>
<p>・SDK1.0.1 でとりあえずやる</p>
<p>・ESP13 で現在のソースが動作するか検証</p>
<p>・いけそうなら、PCBをESP13 に書き換えて、プリント基板発注</p>
<p>・どうしてもだめなら、ESP12 版のPCB を作り検証</p>
<p>・まずは、esphttpd の動作を検証するため、単体で動作を確認（初回APにアクセスする部分の挙動が不明なので）</p>
<p>・パッチを作っているひと発見。<a title="http://www.chaoscode.eu/data/espeink/" href="http://www.chaoscode.eu/data/espeink/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://www.chaoscode.eu/data/espeink/<span class="wpel-icon wpel-image wpel-icon-1"></span></a> このパッチは何しているか検討。</p>
<p>&#160;</p>
<p>という長期決戦です。</p>
<p>&#160;</p>
<p>&#160;</p>
<p>&#8212;&#8212;- 以下、記事を書いたときのもの</p>
<p>作者のサイトで質問していましたが、Alden さんがコンパイルのヒントを書いておいてくれたようです。</p>
<blockquote>
<p><a title="http://spritesmods.com/?art=einkdisplay&amp;page=7" href="http://spritesmods.com/?art=einkdisplay&amp;page=7" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://spritesmods.com/?art=einkdisplay&amp;page=7<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
</blockquote>
<p>どうやら、SDK は、2015年の4月中旬のものということなので、esp_iot_sdk_v1.0.1_15_04_24.zip だと思います。検証でもコンパイルエラーは出ませんでした。変更するところは、以下のようです。</p>
<p><strike>&#8212; includes/c_types.h</strike></p>
<p><strike>#if 0 の部分と #endif の行 11 と 26 のようです。</strike></p>
<p>&#160;</p>
<p>esptool は C 製のesptool-ck を使うと。</p>
<p>webpages.espfs のところを、find. | を挿入せよと。</p>
<p>&#160;</p>
<p>今コードを見ていないので、次回チャレンジするときはこの部分を注意してやってみます。</p>
<p><a title="http://www.esp8266.com/viewtopic.php?f=34&amp;t=5748" href="http://www.esp8266.com/viewtopic.php?f=34&amp;t=5748" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-right">http://www.esp8266.com/viewtopic.php?f=34&amp;t=5748<span class="wpel-icon wpel-image wpel-icon-1"></span></a></p>
<p><strike>ここで、作者がコメントしていました。質問者は、SDK1.4 だとerror が出るよと。作者はリポジトリをFix しておいたから以下のコマンドで使って更新して再度やってみたらと。この投稿が9月30 日のようです。自分が試したときは9月28 日以前でした。</strike></p>
<p><strike>git pull</strike></p>
<p><strike>git submodule update</strike></p>
<p>&#160;</p>
<p>とりあえず、もう一度コンパイルしてみます。</p>
<p>そして、うまく行けば本格的にプロジェクト再開です。</p>
<p>&#160;</p>
<p>▼こんど試すときのメモ</p>
<p><em>・sdk1.0.1 でソース変更してやってみる</em></p>
<p><em>・sdk1.4 最新にして、リポジトリを最新のにしてからコンパイル</em></p>
					</div><!-- .entry-content -->

			<footer class="entry-footer">
							
			</footer><!-- .entry-footer -->
		</div><!-- .entry-wrapper -->
</article><!-- #post-## -->

			
			
	<nav class="navigation posts-navigation" role="navigation" aria-label="投稿">
		<h2 class="screen-reader-text">投稿ナビゲーション</h2>
		<div class="nav-links"><div class="nav-previous"><a href="./../category/osx/page/2.html" data-wpel-link="internal" rel="noopener noreferrer">過去の投稿</a></div></div>
	</nav>
		
		</main><!-- #main -->
	</section><!-- #primary -->


	</div><!-- #content -->

	<footer id="colophon" class="site-footer wrap" role="contentinfo">
		<div class="site-info">
			Copyleft - all rights reversed.
			<span class="sep"> | </span>
			JunkHack 2011 - 2021
			<span class="sep"> | </span>
			<a href="https://junkhack.gpl.jp/about-junkhack/" data-wpel-link="internal" rel="noopener noreferrer">運営者情報<span class="gf"></a><span class="sep"> | </span>
			<a href="https://junkhack.gpl.jp/sendmail/" data-wpel-link="internal" rel="noopener noreferrer">お問い合わせ<span class="gf"></a><span class="sep"> | </span>
			<a href="https://junkhack.gpl.jp/privacy/" data-wpel-link="internal" rel="noopener noreferrer">プライバシーポリシー<span class="gf"></a>
		</div><!-- .site-info -->

	</footer><!-- #colophon -->
</div><!-- #page -->

        <div id="wpfront-scroll-top-container">
            <img src="./../images/1.png" alt="" />        </div>
                <script type="text/javascript">
            function wpfront_scroll_top_init() {
                if (typeof wpfront_scroll_top === "function" && typeof jQuery !== "undefined") {
                    wpfront_scroll_top({"scroll_offset":100,"button_width":0,"button_height":0,"button_opacity":0.8,"button_fade_duration":200,"scroll_duration":400,"location":1,"marginX":20,"marginY":20,"hide_iframe":false,"auto_hide":false,"auto_hide_after":2,"button_action":"top","button_action_element_selector":"","button_action_container_selector":"html, body","button_action_element_offset":0});
                } else {
                    setTimeout(wpfront_scroll_top_init, 100);
                }
            }
            wpfront_scroll_top_init();
        </script>
        <script type='text/javascript' src='./../js/core.min.js' id='jquery-ui-core-js'></script>
<script type='text/javascript' src='./../js/menu.min.js' id='jquery-ui-menu-js'></script>
<script type='text/javascript' src='./../js/wp-polyfill.min.js' id='wp-polyfill-js'></script>
<script type='text/javascript' id='wp-polyfill-js-after'>
( 'fetch' in window ) || document.write( '<script src="https://hack.gpl.jp/wp-includes/js/dist/vendor/wp-polyfill-fetch.min.js?ver=3.0.0"></scr' + 'ipt>' );( document.contains ) || document.write( '<script src="https://hack.gpl.jp/wp-includes/js/dist/vendor/wp-polyfill-node-contains.min.js?ver=3.42.0"></scr' + 'ipt>' );( window.DOMRect ) || document.write( '<script src="https://hack.gpl.jp/wp-includes/js/dist/vendor/wp-polyfill-dom-rect.min.js?ver=3.42.0"></scr' + 'ipt>' );( window.URL && window.URL.prototype && window.URLSearchParams ) || document.write( '<script src="https://hack.gpl.jp/wp-includes/js/dist/vendor/wp-polyfill-url.min.js?ver=3.6.4"></scr' + 'ipt>' );( window.FormData && window.FormData.prototype.keys ) || document.write( '<script src="https://hack.gpl.jp/wp-includes/js/dist/vendor/wp-polyfill-formdata.min.js?ver=3.0.12"></scr' + 'ipt>' );( Element.prototype.matches && Element.prototype.closest ) || document.write( '<script src="https://hack.gpl.jp/wp-includes/js/dist/vendor/wp-polyfill-element-closest.min.js?ver=2.0.2"></scr' + 'ipt>' );( 'objectFit' in document.documentElement.style ) || document.write( '<script src="https://hack.gpl.jp/wp-includes/js/dist/vendor/wp-polyfill-object-fit.min.js?ver=2.3.4"></scr' + 'ipt>' );
</script>
<script type='text/javascript' src='./../js/dom-ready.min.js' id='wp-dom-ready-js'></script>
<script type='text/javascript' src='./../js/hooks.min.js' id='wp-hooks-js'></script>
<script type='text/javascript' src='./../js/i18n.min.js' id='wp-i18n-js'></script>
<script type='text/javascript' id='wp-i18n-js-after'>
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>
<script type='text/javascript' id='wp-a11y-js-translations'>
( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "default", {"translation-revision-date":"2021-05-20 01:00:08+0000","generator":"GlotPress\/3.0.0-alpha.2","domain":"messages","locale_data":{"messages":{"":{"domain":"messages","plural-forms":"nplurals=1; plural=0;","lang":"ja_JP"},"Notifications":["\u901a\u77e5"]}},"comment":{"reference":"wp-includes\/js\/dist\/a11y.js"}} );
</script>
<script type='text/javascript' src='./../js/a11y.min.js' id='wp-a11y-js'></script>
<script type='text/javascript' id='jquery-ui-autocomplete-js-extra'>
/* <![CDATA[ */
var uiAutocompleteL10n = {"noResults":"\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002","oneResult":"1\u4ef6\u306e\u7d50\u679c\u304c\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u3002\u4e0a\u4e0b\u30ad\u30fc\u3092\u4f7f\u3063\u3066\u64cd\u4f5c\u3067\u304d\u307e\u3059\u3002","manyResults":"%d\u4ef6\u306e\u7d50\u679c\u304c\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u3002\u4e0a\u4e0b\u30ad\u30fc\u3092\u4f7f\u3063\u3066\u64cd\u4f5c\u3067\u304d\u307e\u3059\u3002","itemSelected":"\u9805\u76ee\u3092\u9078\u629e\u3057\u307e\u3057\u305f\u3002"};
/* ]]> */
</script>
<script type='text/javascript' src='./../js/autocomplete.min.js' id='jquery-ui-autocomplete-js'></script>
<script type='text/javascript' src='./../js/wpfront-scroll-top.min.js' id='wpfront-scroll-top-js'></script>
<script type='text/javascript' src='./../js/hew.js' id='hew-scripts-js'></script>
<script type='text/javascript' src='./../js/navigation.js' id='hew-navigation-js'></script>
<script type='text/javascript' src='./../js/skip-link-focus-fix.js' id='hew-skip-link-focus-fix-js'></script>
<script type='text/javascript' src='./../js/wp-embed.min.js' id='wp-embed-js'></script>

</body>
</html>

<!--This file was exported by "Export WP Page to Static HTML" plugin which created by ReCorp (https://myrecorp.com) -->